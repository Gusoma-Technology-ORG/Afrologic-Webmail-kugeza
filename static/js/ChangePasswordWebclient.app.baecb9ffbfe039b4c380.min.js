(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"3Y+r":function(s,t,n){"use strict";var e=n("F/us"),o=n("SQrT"),i={checkIfFieldsEmpty:function(s,t){var n=e.find(s,(function(s){return""===s()}));return!n||(t&&o.showError(t),n.focused(!0),!1)},checkPassword:function(s,t){var e=n("RN+F"),i=n("hPb3"),r=!1;return t!==s?o.showError(e.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")):i.PasswordMinLength>0&&s.length<i.PasswordMinLength?o.showError(e.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SHORT").replace("%N%",i.PasswordMinLength)):!i.PasswordMustBeComplex||s.match(/([0-9])/)&&s.match(/([!,%,&,@,#,$,^,*,?,_,~])/)?r=!0:o.showError(e.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SIMPLE")),r}};s.exports=i},"4RXH":function(s,t,n){"use strict";var e=n("F/us"),o=n("AFLV");s.exports={ShowSingleMailChangePasswordInCommonSettings:!1,ShowSingleMailChangePasswordInSecuritySettings:!1,init:function(s){var t=s.ChangePasswordWebclient;e.isEmpty(t)||(this.ShowSingleMailChangePasswordInCommonSettings=o.pBool(t.ShowSingleMailChangePasswordInCommonSettings,this.ShowSingleMailChangePasswordInCommonSettings),this.ShowSingleMailChangePasswordInSecuritySettings=o.pBool(t.ShowSingleMailChangePasswordInSecuritySettings,this.ShowSingleMailChangePasswordInSecuritySettings))}}},MLmf:function(s,t,n){"use strict";s.exports=function(s){if(n("IAk5").isUserNormalOrTenant()){var t=n("4RXH");return t.init(s),{start:function(s){t.ShowSingleMailChangePasswordInSecuritySettings&&s.isModuleEnabled("SecuritySettingsWebclient")?s.run("SecuritySettingsWebclient","registerSecuritySettingsSection",[function(){return n("mDwq")},"ChangePasswordWebclient"]):t.ShowSingleMailChangePasswordInCommonSettings&&s.run("SettingsWebclient","registerSettingsTabSection",[function(){return n("mDwq")},"common"])},getChangePasswordPopup:function(){return n("a7cI")},isChangePasswordButtonAllowed:function(s,n){return!t.ShowSingleMailChangePasswordInCommonSettings&&!t.ShowSingleMailChangePasswordInSecuritySettings&&!!n.aExtend.AllowChangePasswordOnMailServer}}}return null}},a7cI:function(s,t,n){"use strict";var e=n("F/us"),o=n("EVdn"),i=n("0h2I"),r=n("RN+F"),a=(n("ZP6a"),n("3Y+r")),h=n("o0Bx"),u=n("JFZZ"),c=n("IAk5"),w=n("SQrT"),d=n("76Kh"),l=n("1grR"),P=n("czxF");n("4RXH");function S(){P.call(this),this.currentPassword=i.observable(""),this.newPassword=i.observable(""),this.confirmPassword=i.observable(""),this.accountId=i.observable(""),this.hasOldPassword=i.observable(!1),this.oParams=null}e.extendOwn(S.prototype,P.prototype),S.prototype.PopupTemplate="ChangePasswordWebclient_ChangePasswordPopup",S.prototype.onOpen=function(s){this.currentPassword(""),this.newPassword(""),this.confirmPassword(""),this.accountId(s.iAccountId),this.hasOldPassword(s.bHasOldPassword),this.oParams=s},S.prototype.change=function(){var s=o.trim(this.newPassword()),t=o.trim(this.confirmPassword());a.checkPassword(s,t)&&this.sendChangeRequest()},S.prototype.sendChangeRequest=function(){var s={AccountId:this.accountId(),CurrentPassword:o.trim(this.currentPassword()),NewPassword:o.trim(this.newPassword())},t={Module:this.oParams.sModule,Method:"ChangePassword"};h.send(this.oParams.sModule,"ChangePassword",s,this.onUpdatePasswordResponse,this),h.abortAndStopSendRequests(t)},S.prototype.onUpdatePasswordResponse=function(s,t){!1===s.Result?(u.showErrorByCode(s,r.i18n("CHANGEPASSWORDWEBCLIENT/ERROR_PASSWORD_NOT_SAVED")),h.startSendRequests()):s.Result&&s.Result.RefreshToken?(c.setAuthToken(s.Result.RefreshToken),d.showPopup(l,[r.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")+" "+r.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_REDIRECT_TO_LOGIN"),function(){c.logout()}])):(this.hasOldPassword()?w.showReport(r.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")):w.showReport(r.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_SET")),this.closePopup(),o.isFunction(this.oParams.fAfterPasswordChanged)&&this.oParams.fAfterPasswordChanged())},s.exports=new S},mDwq:function(s,t,n){"use strict";var e=n("F/us"),o=n("0h2I"),i=n("RN+F"),r=n("OgeD"),a=n("76Kh"),h=r.run("ChangePasswordWebclient","getChangePasswordPopup");n("4RXH");function u(){this.oDefaultAccount=null,this.showChangePasswordButton=o.observable(!1),this.changePasswordHintText=o.observable(""),this.init()}u.prototype.ViewTemplate="ChangePasswordWebclient_ChangeDefaultMailAccountPasswordView",u.prototype.init=function(){var s=r.run("MailWebclient","getAccountList",[]),t=function(){var t=s.getDefault();t&&t.aExtend.AllowChangePasswordOnMailServer?(this.oDefaultAccount=t,this.showChangePasswordButton(!0),this.changePasswordHintText(i.i18n("CHANGEPASSWORDWEBCLIENT/HINT_CHANGE_PASSWORD",{EMAIL:t.email()}))):(this.oDefaultAccount=null,this.showChangePasswordButton(!1))}.bind(this);s&&e.isFunction(s.collection)&&(t(),s.collection.subscribe(t))},u.prototype.changePassword=function(){this.oDefaultAccount&&a.showPopup(h,[{iAccountId:this.oDefaultAccount.id(),sModule:"Mail",bHasOldPassword:!0}])},s.exports=new u}}]);