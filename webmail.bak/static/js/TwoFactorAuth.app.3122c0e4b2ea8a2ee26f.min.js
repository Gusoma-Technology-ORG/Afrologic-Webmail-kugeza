(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"2h1X":function(t,e,i){"use strict";var s=i("F/us"),o=i("0h2I"),r=i("RN+F"),n=i("Yjhd"),a=i("o0Bx"),c=i("JFZZ"),u=i("IAk5"),h=i("czxF"),p=i("SQrT"),d=i("svu5"),l=i("XIpS"),y=i("7Lti");function f(){h.call(this),this.isMobile=o.observable(u.isMobile()||!1),this.fAfterVerify=null,this.fOnCancel=null,this.login=o.observable(null),this.sPassword=null,this.bAllowTrustedDevices=y.AllowTrustedDevices,this.verificationResponse=o.observable(null),this.verificationPassed=o.computed((function(){return null!==this.verificationResponse()}),this),this.verificationResponse.subscribe((function(){this.verificationPassed()&&!this.bAllowTrustedDevices&&(this.afterVerify(),this.closePopup())}),this),this.trustThisBrowser=o.observable(!1),this.sTrustThisBrowserText=r.i18n("TWOFACTORAUTH/LABEL_TRUST_DEVICE_PLURAL",{COUNT:y.TrustDevicesForDays},null,y.TrustDevicesForDays),this.allOptionsVisible=o.observable(!1),this.securityKeyVisible=o.observable(!1),this.authenticatorAppVisible=o.observable(!1),this.backupCodesVisible=o.observable(!1),this.hasSecurityKey=o.observable(!1),this.securityKeyInProgress=o.observable(!1),this.securityKeyError=o.observable(!1),this.bSecurityKeysNotSupportedError=!(navigator.credentials&&navigator.credentials.get),this.bIsHttps="https:"===window.location.protocol,this.hasAuthenticatorApp=o.observable(!1),this.authenticatorCode=o.observable(""),this.authenticatorCodeFocused=o.observable(!1),this.authenticatorCodeInProgress=o.observable(!1),this.hasBackupCodes=o.observable(!1),this.backupCode=o.observable(!1),this.backupCodeFocus=o.observable(!1),this.backupCodeInProgress=o.observable(!1),this.hasSeveralOptions=o.computed((function(){var t=0;return this.hasSecurityKey()&&t++,this.hasAuthenticatorApp()&&t++,this.hasBackupCodes()&&t++,t>1}),this),this.continueInProgress=o.observable(!1),this.continueCommand=n.createCommand(this,this.afterVerify,(function(){return!this.continueInProgress()}))}s.extendOwn(f.prototype,h.prototype),f.prototype.PopupTemplate="TwoFactorAuth_VerifySecondFactorPopup",f.prototype.onOpen=function(t,e,i,s,o){this.continueInProgress(!1),this.fAfterVerify=t,this.fOnCancel=e,this.login(s),this.sPassword=o,this.hasSecurityKey(y.AllowSecurityKeys&&i.HasSecurityKey),this.hasAuthenticatorApp(y.AllowAuthenticatorApp&&i.HasAuthenticatorApp),this.hasBackupCodes(y.AllowBackupCodes&&i.HasBackupCodes),this.verificationResponse(null),this.authenticatorCode(""),this.authenticatorCodeInProgress(!1),this.backupCode(""),this.backupCodeInProgress(!1),this.allOptionsVisible(!1),this.securityKeyVisible(!1),this.authenticatorAppVisible(!1),this.backupCodesVisible(!1),this.hasSecurityKey()?this.useSecurityKey():this.hasAuthenticatorApp()&&this.useAuthenticatorApp()},f.prototype.useOtherOption=function(){this.allOptionsVisible(!0),this.securityKeyVisible(!1),this.authenticatorAppVisible(!1),this.backupCodesVisible(!1)},f.prototype.useSecurityKey=function(){this.hasSecurityKey()&&(this.allOptionsVisible(!1),this.securityKeyVisible(!0),this.authenticatorAppVisible(!1),this.backupCodesVisible(!1),this.verifySecurityKey())},f.prototype.useAuthenticatorApp=function(){this.hasAuthenticatorApp()&&(this.allOptionsVisible(!1),this.securityKeyVisible(!1),this.authenticatorAppVisible(!0),this.backupCodesVisible(!1),this.authenticatorCodeFocused(!0))},f.prototype.useBackupCodes=function(){this.hasBackupCodes()&&(this.allOptionsVisible(!1),this.securityKeyVisible(!1),this.authenticatorAppVisible(!1),this.backupCodesVisible(!0),this.backupCodeFocus(!0))},f.prototype.verifySecurityKey=function(){if(this.bSecurityKeysNotSupportedError)this.securityKeyInProgress(!1),this.securityKeyError(!0);else{var t={Login:this.login(),Password:this.sPassword};this.securityKeyInProgress(!0),this.securityKeyError(!1),a.send("TwoFactorAuth","VerifySecurityKeyBegin",t,this.onVerifySecurityKeyBegin,this)}},f.prototype.onVerifySecurityKeyBegin=function(t){var e=this,i=t&&t.Result;i?(i.publicKey.challenge=d.base64ToArrayBuffer(i.publicKey.challenge),i.publicKey.allowCredentials.forEach((function(t){t.id=d.base64ToArrayBuffer(t.id)})),navigator.credentials.get(i).then((function(t){var i=t&&t.response,s={Login:e.login(),Password:e.sPassword,Attestation:{id:t&&t.rawId?d.arrayBufferToBase64(t.rawId):null,clientDataJSON:i&&i.clientDataJSON?d.arrayBufferToBase64(i.clientDataJSON):null,authenticatorData:i&&i.authenticatorData?d.arrayBufferToBase64(i.authenticatorData):null,signature:i&&i.signature?d.arrayBufferToBase64(i.signature):null}};a.send("TwoFactorAuth","VerifySecurityKeyFinish",s,e.onVerifySecurityKeyFinish,e)})).catch((function(t){e.securityKeyInProgress(!1),e.securityKeyError(!0)}))):(this.securityKeyInProgress(!1),this.securityKeyError(!0),c.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_VERIFY_SECURITY_KEY")))},f.prototype.onVerifySecurityKeyFinish=function(t){this.securityKeyInProgress(!1),t&&t.Result?this.verificationResponse(t):(this.securityKeyError(!0),c.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_VERIFY_SECURITY_KEY")))},f.prototype.verifyAuthenticatorCode=function(){var t={Login:this.login(),Password:this.sPassword,Code:this.authenticatorCode()};this.authenticatorCodeInProgress(!0),a.send("TwoFactorAuth","VerifyAuthenticatorAppCode",t,this.onVerifyAuthenticatorAppCodeResponse,this)},f.prototype.onVerifyAuthenticatorAppCodeResponse=function(t){var e=t.Result;this.authenticatorCodeInProgress(!1),this.authenticatorCode(""),e?this.verificationResponse(t):p.showError(r.i18n("TWOFACTORAUTH/ERROR_WRONG_CODE"))},f.prototype.verifyBackupCode=function(){var t={Login:this.login(),Password:this.sPassword,BackupCode:this.backupCode()};this.backupCodeInProgress(!0),a.send("TwoFactorAuth","VerifyBackupCode",t,this.onVerifyBackupCode,this)},f.prototype.onVerifyBackupCode=function(t){var e=t.Result;this.backupCodeInProgress(!1),this.backupCode(""),e?this.verificationResponse(t):p.showError(r.i18n("TWOFACTORAUTH/ERROR_WRONG_BACKUP_CODE"))},f.prototype.cancelPopup=function(){s.isFunction(this.fOnCancel)&&this.fOnCancel(!1),this.closePopup()},f.prototype.afterVerify=function(){if(this.trustThisBrowser()){var t={Login:this.login(),Password:this.sPassword,DeviceId:n.getUUID(),DeviceName:l.getName(),Trust:this.trustThisBrowser()};this.continueInProgress(!0),a.send("TwoFactorAuth","TrustDevice",t,(function(){s.isFunction(this.fAfterVerify)&&this.fAfterVerify(this.verificationResponse())}),this)}else s.isFunction(this.fAfterVerify)&&this.fAfterVerify(this.verificationResponse())},t.exports=new f},"2xdY":function(t,e,i){"use strict";var s=i("F/us"),o=i("0h2I"),r=i("RN+F"),n=i("o0Bx"),a=i("JFZZ"),c=i("czxF");function u(){c.call(this),this.fSuccessCallback=null,this.password=o.observable(""),this.passwordFocus=o.observable(!0),this.inProgress=o.observable(!1)}s.extendOwn(u.prototype,c.prototype),u.prototype.PopupTemplate="TwoFactorAuth_ConfirmPasswordPopup",u.prototype.onOpen=function(t){this.fSuccessCallback=t,this.password(""),this.passwordFocus(!0)},u.prototype.verifyPassword=function(){var t={Password:this.password()};this.inProgress(!0),n.send("TwoFactorAuth","VerifyPassword",t,this.onVerifyPasswordResponse,this)},u.prototype.onVerifyPasswordResponse=function(t){this.inProgress(!1),t&&t.Result?(s.isFunction(this.fSuccessCallback)&&this.fSuccessCallback(this.password()),this.closePopup()):a.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_WRONG_PASSWORD"))},t.exports=new u},"3eSs":function(t,e,i){"use strict";(function(e){var s=i("F/us"),o=i("0h2I"),r=i("wd/R"),n=i("RN+F"),a=i("AFLV"),c=i("Yjhd"),u=i("o0Bx"),h=i("IAk5"),p=i("czxF"),d=i("20Ah"),l=i("uN/E"),y=i("76Kh"),f=i("ZCBP"),A=i("7Lti");function C(){p.call(this),this.sEditVerificator="",this.backupCodes=o.observableArray([]),this.codesGeneratedDataInfo=o.observable(""),this.fCallBack=null,this.generatingBackupCodes=o.observable(!1),this.generateBackupCodesCommand=c.createCommand(this,this.confirmGenerateNewBackupCodes,(function(){return!this.generatingBackupCodes()}))}s.extendOwn(C.prototype,p.prototype),C.prototype.PopupTemplate="TwoFactorAuth_ShowBackupCodesPopup",C.prototype.onOpen=function(t,e){this.sEditVerificator=t,this.fCallBack=e,A.BackupCodesCount>0?this.getBackupCodes():(this.backupCodes([]),this.codesGeneratedDataInfo(""),this.generateBackupCodes())},C.prototype.onClose=function(){s.isFunction(this.fCallBack)&&this.fCallBack(s.without(this.backupCodes(),"").length)},C.prototype.getBackupCodes=function(){this.backupCodes([]),this.codesGeneratedDataInfo(""),this.generatingBackupCodes(!0),u.send("TwoFactorAuth","GetBackupCodes",{Password:this.sEditVerificator},(function(t){this.generatingBackupCodes(!1),this.parseBackupCodes(t)}),this)},C.prototype.confirmGenerateNewBackupCodes=function(){y.showPopup(d,[n.i18n("TWOFACTORAUTH/INFO_GET_NEW_CODES"),function(t){t&&this.generateBackupCodes()}.bind(this),n.i18n("TWOFACTORAUTH/CONFIRM_GET_NEW_CODES")])},C.prototype.generateBackupCodes=function(){this.generatingBackupCodes(!0),u.send("TwoFactorAuth","GenerateBackupCodes",{Password:this.sEditVerificator},(function(t){this.generatingBackupCodes(!1),this.parseBackupCodes(t)}),this)},C.prototype.parseBackupCodes=function(t){var e=t&&t.Result,i=e&&e.Codes;if(a.isNonEmptyArray(i)){var s=r.unix(e.Datetime);this.codesGeneratedDataInfo(n.i18n("TWOFACTORAUTH/INFO_CODES_GENERATED_DATA",{DATA:s.format("MMM D, YYYY")})),this.backupCodes(i)}},C.prototype.getBackupCodesFileText=function(){var t="";return t+=n.i18n("TWOFACTORAUTH/HEADING_SAVE_CODES")+"\n",t+=n.i18n("TWOFACTORAUTH/INFO_KEEP_CODES_SAFE")+"\n",t+="\n",s.each(this.backupCodes(),(function(e,i){t+=i+1+". "+e+"\n"})),t+="\n",t+=h.getUserPublicId()+"\n",t+="\n",t+=n.i18n("TWOFACTORAUTH/INFO_USE_CODE_ONCE")+"\n",t+=this.codesGeneratedDataInfo()+"\n"},C.prototype.print=function(){var t=this.getBackupCodesFileText(),i=f.open("","backup-codes-"+h.getUserPublicId()+"-print");i&&(e(i.document.body).html("<pre>"+t+"</pre>"),i.print())},C.prototype.download=function(){var t=this.getBackupCodesFileText(),e=new Blob([t],{type:"text/plain;charset=utf-8"});l.saveAs(e,"backup-codes-"+h.getUserPublicId()+".txt",!0)},t.exports=new C}).call(this,i("EVdn"))},"7Lti":function(t,e,i){"use strict";(function(e){var s=i("0h2I"),o=i("F/us"),r=i("RN+F"),n=i("AFLV"),a=i("IAk5"),c=i("OgeD"),u=i("SQrT");t.exports={ServerModuleName:"TwoFactorAuth",HashModuleName:"two-factor-auth",AuthenticatorAppEnabled:!1,ShowRecommendationToConfigure:!0,AllowBackupCodes:!1,BackupCodesCount:!1,AllowSecurityKeys:!1,AllowAuthenticatorApp:!1,SecurityKeys:[],AllowUsedDevices:!1,CurrentIP:"",TrustDevicesForDays:0,AllowTrustedDevices:!1,init:function(t){var e=o.extend({},t[this.ServerModuleName]||{},t.TwoFactorAuth||{});o.isEmpty(e)||(this.ShowRecommendationToConfigure=n.pBool(e.ShowRecommendationToConfigure,this.ShowRecommendationToConfigure),this.AllowBackupCodes=n.pBool(e.AllowBackupCodes,this.AllowBackupCodes),this.BackupCodesCount=n.pInt(e.BackupCodesCount,this.BackupCodesCount),this.AllowSecurityKeys=n.pBool(e.AllowSecurityKeys,this.AllowSecurityKeys),this.AllowAuthenticatorApp=n.pBool(e.AllowAuthenticatorApp,this.AllowAuthenticatorApp),this.AuthenticatorAppEnabled=this.AllowAuthenticatorApp&&n.pBool(e.AuthenticatorAppEnabled,this.AuthenticatorAppEnabled),this.AllowUsedDevices=n.pBool(e.AllowUsedDevices,this.AllowUsedDevices),this.CurrentIP=n.pString(e.CurrentIP,this.CurrentIP),this.TrustDevicesForDays=n.pInt(e.TrustDevicesForDays,this.TrustDevicesForDays),this.AllowTrustedDevices=this.TrustDevicesForDays>0,this.SecurityKeys=[],n.isNonEmptyArray(e.WebAuthKeysInfo)&&o.each(e.WebAuthKeysInfo,function(t){n.isNonEmptyArray(t,2)&&this.SecurityKeys.push({Id:t[0],keyName:s.observable(t[1])})}.bind(this)),this.checkIfEnabled())},updateShowRecommendation:function(t){this.ShowRecommendationToConfigure=t},updateBackupCodesCount:function(t){this.BackupCodesCount=t},updateAuthenticatorApp:function(t){this.AuthenticatorAppEnabled=!!t},checkIfEnabled:function(){if(!a.isMobile()&&a.isUserNormalOrTenant()&&this.ShowRecommendationToConfigure){var t="settings/two-factor-auth"===window.location.hash||"#settings/two-factor-auth"===window.location.hash,i="settings/security"===window.location.hash||"#settings/security"===window.location.hash;this.AuthenticatorAppEnabled||t||i||setTimeout((function(){var t=c.isModuleEnabled("SecuritySettingsWebclient")?"#settings/security":"#settings/two-factor-auth";u.showLoading(r.i18n("TWOFACTORAUTH/CONFIRM_MODULE_NOT_ENABLED",{TWO_FACTOR_LINK:t})),e(".report_panel.loading a").on("click",(function(){u.hideLoading()})),setTimeout((function(){u.hideLoading()}),1e4)}),100)}}}}).call(this,i("EVdn"))},"7yJo":function(t,e,i){"use strict";var s=i("wd/R"),o=i("RN+F"),r=i("AFLV"),n=i("Yjhd"),a=i("7Lti");function c(t){this.sDeviceId="",this.bCurrentDevice=!1,this.sDeviceName="",this.bAuthenticated=!1,this.sDeviceExpiresDate="",this.sDeviceLastUsageDate="",t&&this.parse(t)}c.prototype.parse=function(t){var e=s.unix(t.TrustTillDateTime),i=s.unix(t.LastUsageDateTime);this.sDeviceId=r.pString(t.DeviceId),this.bCurrentDevice=this.sDeviceId===n.getUUID(),this.bAuthenticated=r.pBool(t.Authenticated),this.sDeviceName=r.pString(t.DeviceName),a.AllowTrustedDevices&&e.diff(s())>0&&(this.sDeviceExpiresDate=o.i18n("TWOFACTORAUTH/LABEL_DEVICE_TRUST_TILL_DATE",{EXPDATE:e.format("MMM D, YYYY")})),this.sDeviceLastUsageDate=o.i18n("TWOFACTORAUTH/LABEL_DEVICE_LAST_USAGE_DATE",{USAGEDATE:i.fromNow()})},t.exports=c},J4qX:function(t,e,i){"use strict";var s=i("F/us"),o=i("0h2I"),r=i("RN+F"),n=i("AFLV"),a=i("Yjhd"),c=i("o0Bx"),u=i("JFZZ"),h=i("czxF"),p=(i("SQrT"),i("svu5"));function d(){h.call(this),this.bSecurityKeysNotSupportedError=!(navigator.credentials&&navigator.credentials.create),this.bIsHttps="https:"===window.location.protocol,this.sEditVerificator="",this.sName="",this.iId=0,this.name=o.observable(""),this.nameFocus=o.observable(!0),this.saveNameInProgress=o.observable(!1),this.securityKeyInProgress=o.observable(!1),this.securityKeyError=o.observable(!1),this.securityKeyCanceled=o.observable(!1),this.saveCommand=a.createCommand(this,this.save,(function(){return n.isNonEmptyString(this.name())}))}s.extendOwn(d.prototype,h.prototype),d.prototype.PopupTemplate="TwoFactorAuth_CreateSecurityKeyPopup",d.prototype.onOpen=function(t,e){this.sEditVerificator=t,this.fCallback=e,this.registerSecurityKey()},d.prototype.registerSecurityKey=function(t){this.bSecurityKeysNotSupportedError?(this.securityKeyInProgress(!1),this.securityKeyError(!0)):(this.iId=0,this.name(""),this.securityKeyInProgress(!0),this.securityKeyError(!1),this.securityKeyCanceled(!1),c.send("TwoFactorAuth","RegisterSecurityKeyBegin",{Password:this.sEditVerificator},this.onRegisterSecurityKeyBeginResponse,this))},d.prototype.onRegisterSecurityKeyBeginResponse=function(t){var e=this;if(t&&t.Result){var i=t.Result;i.publicKey.challenge=p.base64ToArrayBuffer(i.publicKey.challenge),i.publicKey.user.id=p.base64ToArrayBuffer(i.publicKey.user.id),navigator.credentials.create(i).then((function(t){var i={Password:e.sEditVerificator,Attestation:{attestationObject:p.arrayBufferToBase64(t.response.attestationObject),clientDataJSON:p.arrayBufferToBase64(t.response.clientDataJSON)}};c.send("TwoFactorAuth","RegisterSecurityKeyFinish",i,e.onRegisterSecurityKeyFinishResponse,e)})).catch((function(t){e.securityKeyInProgress(!1),e.securityKeyCanceled(!0)}))}else this.securityKeyInProgress(!1),this.closePopup(),u.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_ADD_SECURITY_KEY"))},d.prototype.onRegisterSecurityKeyFinishResponse=function(t){this.securityKeyInProgress(!1),t&&t.Result?(this.iId=t.Result,this.nameFocus(!0)):(this.closePopup(),u.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_ADD_SECURITY_KEY")))},d.prototype.save=function(){if(n.isNonEmptyString(this.name())){var t={Password:this.sEditVerificator,KeyId:this.iId,NewName:this.name()};this.saveNameInProgress(!0),c.send("TwoFactorAuth","UpdateSecurityKeyName",t,this.onUpdateSecurityKeyNameResponse,this)}},d.prototype.onUpdateSecurityKeyNameResponse=function(t){this.saveNameInProgress(!1),t&&t.Result?(s.isFunction(this.fCallback)&&this.fCallback(this.iId,this.name()),this.closePopup()):(s.isFunction(this.fCallback)&&this.fCallback(this.iId,""),this.closePopup(),u.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_SETUP_SECRET_KEY_NAME")))},d.prototype.cancelPopup=function(){},d.prototype.onEscHandler=function(t){},t.exports=new d},PMya:function(t,e,i){"use strict";var s=i("F/us"),o=i("0h2I"),r=i("RN+F"),n=i("AFLV"),a=i("Yjhd"),c=i("o0Bx"),u=i("JFZZ"),h=(i("IAk5"),i("20Ah")),p=i("OgeD"),d=i("76Kh"),l=i("SQrT"),y=i("hPb3"),f=p.run("SettingsWebclient","getAbstractSettingsFormViewClass"),A=i("7yJo"),C=i("RfyC"),T=i("2xdY"),b=i("J4qX"),v=i("7Lti"),w=i("piNw"),R=i("3eSs");function E(){f.call(this,v.ServerModuleName),this.visibleHeading=o.observable(!0),this.showRecommendationToConfigure=o.observable(v.ShowRecommendationToConfigure),this.bAllowSecurityKeys=v.AllowSecurityKeys,this.bAllowAuthenticatorApp=v.AllowAuthenticatorApp,this.securityKeys=o.observableArray(v.SecurityKeys),this.hasBackupCodes=o.observable(!1),this.infoShowBackupCodes=o.observable(""),this.hasAuthenticatorApp=o.observable(v.AuthenticatorAppEnabled),this.isEnabledTwoFactorAuth=o.computed((function(){return this.hasAuthenticatorApp()||this.securityKeys().length>0}),this),this.isEnabledTwoFactorAuth.subscribe((function(){this.isEnabledTwoFactorAuth()||(v.updateBackupCodesCount(0),this.populateSettings())}),this),this.sEditVerificator="",this.passwordVerified=o.observable(!1),this.allowBackupCodes=o.computed((function(){return v.AllowBackupCodes&&(this.hasAuthenticatorApp()||this.securityKeys().length>0)&&this.passwordVerified()}),this),this.devices=o.observableArray([]),this.allowUsedDevices=o.computed((function(){return v.AllowUsedDevices&&this.devices().length>0}),this),this.allowRevokeAll=o.computed((function(){return v.AllowTrustedDevices&&!!s.find(this.devices(),(function(t){return n.isNonEmptyString(t.sDeviceExpiresDate)}))}),this),this.bAllowDeviceLogout=y.StoreAuthTokenInDB,this.populateSettings(),this.revokeAllCommand=a.createCommand(this,this.askRevokeTrustFromAllDevices,(function(){return this.allowRevokeAll()}))}s.extendOwn(E.prototype,f.prototype),E.prototype.ViewTemplate="TwoFactorAuth_TwoFactorAuthSettingsFormView",E.prototype.onShow=function(){this.clearAll()},E.prototype.clearAll=function(){this.sEditVerificator="",this.passwordVerified(!1),this.populateSettings(),this.getUsedDevices()},E.prototype.populateSettings=function(){this.showRecommendationToConfigure(v.ShowRecommendationToConfigure),this.hasAuthenticatorApp(v.AuthenticatorAppEnabled),this.hasBackupCodes(v.BackupCodesCount>0),this.infoShowBackupCodes(this.hasBackupCodes()?r.i18n("TWOFACTORAUTH/INFO_SHOW_BACKUP_CODES",{COUNT:v.BackupCodesCount}):"")},E.prototype.confirmPassword=function(){d.showPopup(T,[function(t){this.sEditVerificator=t,this.passwordVerified(!0)}.bind(this)])},E.prototype.setupAuthenticatorApp=function(){d.showPopup(C,[this.sEditVerificator,function(){v.updateAuthenticatorApp(!0),this.populateSettings(),this.disableShowRecommendation()}.bind(this)])},E.prototype.disableShowRecommendation=function(){this.showRecommendationToConfigure()&&(this.showRecommendationToConfigure(!1),c.send("TwoFactorAuth","UpdateSettings",{ShowRecommendationToConfigure:!1},function(){v.updateShowRecommendation(!1),this.populateSettings()}.bind(this)))},E.prototype.askDisableAuthenticatorApp=function(){var t=r.i18n("TWOFACTORAUTH/CONFIRM_DISABLE_AUTHENTICATOR_APP");d.showPopup(h,[t,s.bind((function(t){t&&this.disableAuthenticatorApp()}),this)])},E.prototype.disableAuthenticatorApp=function(){var t={Password:this.sEditVerificator};c.send("TwoFactorAuth","DisableAuthenticatorApp",t),v.updateAuthenticatorApp(!1),this.populateSettings()},E.prototype.showBackupCodes=function(){this.allowBackupCodes()&&d.showPopup(R,[this.sEditVerificator,function(t){v.updateBackupCodesCount(t),this.populateSettings()}.bind(this)])},E.prototype.addSecurityKey=function(){d.showPopup(b,[this.sEditVerificator,this.addCreatedSecurityKey.bind(this)])},E.prototype.addCreatedSecurityKey=function(t,e){this.securityKeys.push({Id:t,keyName:o.observable(e)}),this.disableShowRecommendation()},E.prototype.askNewSecurityKeyName=function(t,e){d.showPopup(w,[this.sEditVerificator,t,e,this.updateSecurityKeyName.bind(this)])},E.prototype.updateSecurityKeyName=function(t,e){s.each(this.securityKeys(),(function(i){i.Id===t&&i.keyName(e)})),this.securityKeys.valueHasMutated()},E.prototype.askRemoveSecurityKey=function(t,e){var i=r.i18n("TWOFACTORAUTH/CONFIRM_REMOVE_SECURITY_KEY",{KEYNAME:e});d.showPopup(h,[i,s.bind((function(e){e&&this.removeSecurityKey(t)}),this)])},E.prototype.removeSecurityKey=function(t){c.send("TwoFactorAuth","DeleteSecurityKey",{Password:this.sEditVerificator,KeyId:t},(function(e){e&&e.Result?(this.securityKeys(s.filter(this.securityKeys(),(function(e){return e.Id!==t}))),l.showReport(r.i18n("TWOFACTORAUTH/REPORT_DELETE_SECURITY_KEY"))):u.showErrorByCode(e,r.i18n("TWOFACTORAUTH/ERROR_DELETE_SECURITY_KEY"))}),this)},E.prototype.getUsedDevices=function(){c.send("TwoFactorAuth","GetUsedDevices",{},(function(t){var e=t&&t.Result,i=[];n.isNonEmptyArray(e)&&s.each(e,(function(t){var e=new A(t);i.push(e)})),this.devices(i)}),this)},E.prototype.askRevokeTrustFromAllDevices=function(){var t=r.i18n("TWOFACTORAUTH/CONFIRM_REVOKE_ALL"),e=r.i18n("TWOFACTORAUTH/CONFIRM_HEADING_REVOKE_ALL");d.showPopup(h,[t,s.bind((function(t){t&&this.revokeTrustFromAllDevices()}),this),e])},E.prototype.revokeTrustFromAllDevices=function(){c.send("TwoFactorAuth","RevokeTrustFromAllDevices",{},(function(t){this.getUsedDevices(),t&&t.Result||u.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_REVOKE_TRUST"))}),this)},E.prototype.askLogoutFromDevice=function(t,e){var i=r.i18n("TWOFACTORAUTH/CONFIRM_LOGOUT_DEVICE"),o=r.i18n("TWOFACTORAUTH/CONFIRM_HEADING_LOGOUT_DEVICE",{NAME:e});d.showPopup(h,[i,s.bind((function(e){e&&this.logoutFromDevice(t)}),this),o])},E.prototype.logoutFromDevice=function(t){var e={DeviceId:t};c.send("TwoFactorAuth","LogoutFromDevice",e,(function(t){this.getUsedDevices(),t&&t.Result||u.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_LOGOUT_DEVICE"))}),this)},E.prototype.askRemoveDevice=function(t,e){var i=r.i18n("TWOFACTORAUTH/CONFIRM_LOGOUT_DEVICE"),o=r.i18n("TWOFACTORAUTH/CONFIRM_HEADING_REMOVE_DEVICE",{NAME:e});d.showPopup(h,[i,s.bind((function(e){e&&this.removeDevice(t)}),this),o])},E.prototype.removeDevice=function(t){var e={DeviceId:t};c.send("TwoFactorAuth","RemoveDevice",e,(function(t){this.getUsedDevices(),t&&t.Result||u.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_LOGOUT_DEVICE"))}),this)},t.exports=new E},RfyC:function(t,e,i){"use strict";var s=i("F/us"),o=i("0h2I"),r=i("RN+F"),n=i("AFLV"),a=i("Yjhd"),c=i("o0Bx"),u=i("JFZZ"),h=i("czxF"),p=i("SQrT");function d(){h.call(this),this.sEditVerificator=null,this.fSuccessCallback=null,this.authenticatorQRCodeUrl=o.observable(""),this.authenticatorSecret=o.observable(""),this.authenticatorCode=o.observable(""),this.authenticatorCodeFocus=o.observable(!1),this.saveInProgress=o.observable(!1),this.qrCodeIsLoading=o.observable(!1),this.saveCommand=a.createCommand(this,this.save,(function(){return n.isNonEmptyString(this.authenticatorQRCodeUrl())&&n.isNonEmptyString(this.authenticatorSecret())&&n.isNonEmptyString(this.authenticatorCode())}))}s.extendOwn(d.prototype,h.prototype),d.prototype.PopupTemplate="TwoFactorAuth_ConfigureAuthenticatorAppPopup",d.prototype.onOpen=function(t,e){this.sEditVerificator=t,this.fSuccessCallback=e,this.authenticatorQRCodeUrl(""),this.authenticatorSecret(""),this.authenticatorCode(""),this.authenticatorCodeFocus(!1),this.saveInProgress(!1),this.qrCodeIsLoading(!0),this.getAuthenticatorAppData()},d.prototype.getAuthenticatorAppData=function(){var t={Password:this.sEditVerificator};c.send("TwoFactorAuth","RegisterAuthenticatorAppBegin",t,this.onRegisterAuthenticatorAppBeginResponse,this)},d.prototype.onRegisterAuthenticatorAppBeginResponse=function(t){var e=t&&t.Result;e&&e.Secret&&e.QRcode?(this.authenticatorQRCodeUrl(e.QRcode),this.authenticatorSecret(e.Secret),this.authenticatorCodeFocus(!0)):u.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_WRONG_PASSWORD"))},d.prototype.save=function(){if(n.isNonEmptyString(this.authenticatorCode())){var t={Password:this.sEditVerificator,Code:this.authenticatorCode(),Secret:this.authenticatorSecret()};this.saveInProgress(!0),c.send("TwoFactorAuth","RegisterAuthenticatorAppFinish",t,this.onRegisterAuthenticatorAppFinishResponse,this)}},d.prototype.onRegisterAuthenticatorAppFinishResponse=function(t){this.saveInProgress(!1),t&&t.Result?(s.isFunction(this.fSuccessCallback)&&this.fSuccessCallback(),this.closePopup()):p.showError(r.i18n("TWOFACTORAUTH/ERROR_WRONG_CODE"))},t.exports=new d},Rr39:function(t,e,i){"use strict";var s=i("F/us"),o=i("RN+F"),r=i("Yjhd"),n=i("o0Bx"),a=i("IAk5"),c=i("XIpS"),u=i("7Lti");t.exports=function(t){return u.init(t),{start:function(t){if(a.isMobile()||(t.isModuleEnabled("SecuritySettingsWebclient")?t.run("SecuritySettingsWebclient","registerSecuritySettingsSection",[function(){return i("PMya")},"TwoFactorAuth"]):t.run("SettingsWebclient","registerSettingsTab",[function(){return i("PMya")},u.HashModuleName,o.i18n("TWOFACTORAUTH/LABEL_SETTINGS_TAB")]),t.run("AdminPanelWebclient","registerAdminPanelTab",[function(t){i.e(26).then(function(){t(i("U4UJ"))}.bind(null,i)).catch(i.oe)},u.HashModuleName,o.i18n("TWOFACTORAUTH/LABEL_SETTINGS_TAB")])),a.getUserRole()===Enums.UserRole.Anonymous){var e=function(t){var e=t.View,o=i("76Kh"),r=i("2h1X");if(e){var n=e.onSystemLoginResponse.bind(e);s.isFunction(n)||(n=e.onSystemLoginResponseBase.bind(e)),s.isFunction(n)||(n=function(){}),e.onSystemLoginResponse=function(t,e){null!=e.Parameters.Domain&&(e.Parameters.Login=e.Parameters.Login+"@"+e.Parameters.Domain);var i=t.Result&&t.Result.TwoFactorAuth;i?o.showPopup(r,[s.bind(this.onSystemLoginResponseBase,this),s.bind((function(){this.loading(!1)}),this),i,e.Parameters.Login,e.Parameters.Password]):n(t,e)}}}.bind(this);a.subscribeEvent("StandardLoginFormWebclient::ConstructView::after",e),a.subscribeEvent("MailLoginFormWebclient::ConstructView::after",e)}if(a.isUserNormalOrTenant()){var h={DeviceId:r.getUUID(),DeviceName:c.getName()};n.send("TwoFactorAuth","SaveDevice",h)}}}}},XIpS:function(t,e,i){"use strict";var s=i("K4CH"),o=i("RN+F"),r=i("AFLV"),n={getName:function(){var t=navigator.userAgent,e=s(r.pString(t)),i=e.browser.name+"/"+e.browser.major,n=e.os.name+" "+e.os.version;return o.i18n("TWOFACTORAUTH/LABEL_DEVICE_NAME",{NAME:i,PLATFORM:n})}};t.exports=n},piNw:function(t,e,i){"use strict";var s=i("F/us"),o=i("0h2I"),r=i("RN+F"),n=i("AFLV"),a=i("Yjhd"),c=i("o0Bx"),u=i("JFZZ"),h=i("czxF");i("SQrT");function p(){h.call(this),this.sEditVerificator="",this.sName="",this.iId=0,this.name=o.observable(""),this.nameFocus=o.observable(!0),this.inProgress=o.observable(!1),this.saveCommand=a.createCommand(this,this.save,(function(){return n.isNonEmptyString(this.name())}))}s.extendOwn(p.prototype,h.prototype),p.prototype.PopupTemplate="TwoFactorAuth_EditSecurityKeyPopup",p.prototype.onOpen=function(t,e,i,s){this.sEditVerificator=t,this.iId=e,this.name(i),this.nameFocus(!0),this.fCallback=s},p.prototype.save=function(){if(n.isNonEmptyString(this.name())){var t={Password:this.sEditVerificator,KeyId:this.iId,NewName:this.name()};this.inProgress(!0),c.send("TwoFactorAuth","UpdateSecurityKeyName",t,this.onUpdateSecurityKeyNameResponse,this)}},p.prototype.onUpdateSecurityKeyNameResponse=function(t){this.inProgress(!1),t&&t.Result?(s.isFunction(this.fCallback)&&this.fCallback(this.iId,this.name()),this.closePopup()):u.showErrorByCode(t,r.i18n("TWOFACTORAUTH/ERROR_SETUP_SECRET_KEY_NAME"))},t.exports=new p},svu5:function(t,e,i){"use strict";var s={base64ToArrayBuffer:function(t){for(var e=window.atob(t),i=e.length,s=new Uint8Array(i),o=0;o<i;o++)s[o]=e.charCodeAt(o);return s.buffer},arrayBufferToBase64:function(t){for(var e="",i=new Uint8Array(t),s=i.byteLength,o=0;o<s;o++)e+=String.fromCharCode(i[o]);return window.btoa(e)}};t.exports=s},"uN/E":function(t,e,i){var s,o=o||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,i=function(){return t.URL||t.webkitURL||t},s=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in s,r=/constructor/i.test(t.HTMLElement)||t.safari,n=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(e){(t.setImmediate||t.setTimeout)((function(){throw e}),0)},c=function(t){setTimeout((function(){"string"==typeof t?i().revokeObjectURL(t):t.remove()}),4e4)},u=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},h=function(e,h,p){p||(e=u(e));var d,l=this,y="application/octet-stream"===e.type,f=function(){!function(t,e,i){for(var s=(e=[].concat(e)).length;s--;){var o=t["on"+e[s]];if("function"==typeof o)try{o.call(t,i||t)}catch(t){a(t)}}}(l,"writestart progress write writeend".split(" "))};if(l.readyState=l.INIT,o)return d=i().createObjectURL(e),void setTimeout((function(){var t,e;s.href=d,s.download=h,t=s,e=new MouseEvent("click"),t.dispatchEvent(e),f(),c(d),l.readyState=l.DONE}));!function(){if((n||y&&r)&&t.FileReader){var s=new FileReader;return s.onloadend=function(){var e=n?s.result:s.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,l.readyState=l.DONE,f()},s.readAsDataURL(e),void(l.readyState=l.INIT)}(d||(d=i().createObjectURL(e)),y)?t.location.href=d:t.open(d,"_blank")||(t.location.href=d);l.readyState=l.DONE,f(),c(d)}()},p=h.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,i){return e=e||t.name||"download",i||(t=u(t)),navigator.msSaveOrOpenBlob(t,e)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,function(t,e,i){return new h(t,e||t.name||"download",i)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);t.exports?t.exports.saveAs=o:null!==i("B9Yq")&&null!==i("PDX0")&&(void 0===(s=function(){return o}.call(e,i,e,t))||(t.exports=s))}}]);